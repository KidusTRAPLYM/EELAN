<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-site-verification" content="TMW5Dt1bYDDzmsriK1iovdFSDoP8geZCU9EdrmTY3M0" />

    <title>Ciphree | Feed</title>
    <link rel="stylesheet" href="/CSS/variables.css" />
    <link rel="stylesheet" href="/CSS/main.css">
    <link rel="stylesheet" href="/CSS/dashboard.css">
    <link rel="stylesheet" href="/CSS/post.css">
    <link rel="icon" href="/Images/ciphry.png">
    <!--FONT FAMILY-->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
 <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
 <meta name="description" content="Discover real stories and emotions shared by the Ciphree community. Feel less alone, post what matters.">


<!-- Open Graph / Facebook -->
<meta
 property="og:title"
 content="Ciphree ‚Äî Share Your True Feelings, Connect, and Heal"
/>
<meta
 property="og:description"
 content="Ciphree is your emotional outlet. Share joy or pain anonymously and connect with others who understand. Real feelings. Real people."
/>
<meta property="og:url" content="https://ciphree.com/" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://ciphree.com/Images/ciphry.png" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta
 name="twitter:title"
 content="Ciphree ‚Äî Share Your True Feelings, Connect, and Heal"
/>
<meta
 name="twitter:description"
 content="Ciphree is your emotional outlet. Share joy or pain anonymously and connect with others who understand. Real feelings. Real people."
/>
<meta
 name="twitter:image"
 content="https://ciphree.com/Images/ciphry.png"
/>

<!-- Fonts and Tailwind -->
<link
 href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
 rel="stylesheet"
/>
<script src="https://cdn.tailwindcss.com"></script>
<script>
 tailwind.config = {
   theme: {
     extend: { fontFamily: { poppins: ["Poppins", "sans-serif"] } },
   },
 };
</script>



<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MM8VSWME23"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-MM8VSWME23');
</script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MM8VSWME23"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MM8VSWME23');
  </script>
  </head>
  <body>
     <header>
<div id="loader" class="loader"> 
  <div class="dot"></div>
  <div class="dot"></div>
  <div class="dot"></div>
</div>
<script>
  window.addEventListener("load", function () {
    const loader = document.getElementById("loader");
    loader.style.opacity = 0; // fade out
    setTimeout(() => {
      loader.style.display = "none"; // remove from DOM flow
    }, 400); // match with CSS transition
  });
</script>


     
</header>
<%- include('partials/navigation', { currentPage: 'feed' }) %>
<div id="page-wrapper">
   <main>
    <div class="themeToggle">
      <button id="themeToggle" class="toggle">
        <span class="switch"></span>
      </button>
    </div>
      
    <section id="body">
  
      <section id="posts">
       
              <% populatedPostData.forEach(post => { %>
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-8 col-lg-6"> 
            <section id="post">
              <section id="upper">
                <section id="left">
                  <div class="account" style="background-color: var(--White--);">
                    <img src="<%= post.userId?.avatar ? post.userId.avatar : '/Images/avatar3.png' %>" 
                    alt="avatar" 
                    style="width: 30px">
               

                  
               


</div>
                  <div class="time">
                    <span><%= post.userId?.name || 'Unknown User' %></span>
                    <span><%= post.timeago || 'N/A' %></span>
                  </div>
                </section>
              </section>
              <section id="down">
                <section id="text">
                  <h1><%=post.type%></h1>
                  <p><%= post.message %></p>
                </section>
                <section id="engagements">
               
                  <div class="comment flex gap-4">
                    <p>Comments: <%= post.commentCount %></p>
                    <a href="/comments/<%=post._id%>">
                      <button id="comment-<%=post._id%>" class="comment-btn">
                  <svg
  xmlns="http://www.w3.org/2000/svg"
  width="36"
  height="36"
  viewBox="0 0 24 24"
  fill="none"
  style="color: #17e"
  stroke="currentColor"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="lucide lucide-message-circle-icon lucide-message-circle"
>
  <path
    d="M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719"
  />
</svg>   

                      </button>
                    </a>
                   
                  </div>
                </section>
              </section>
            </section>
          </div>
        </div>
      </div>
      
    <% }) %>
    <script>
      
    </script>
       
    </section>
                        </section>
    </section>
    </section>
  
      <section id="formPost">
        <form action="/post" method="Post" class="formPost">
          <div class="up">
            <h1>Create a post</h1>
          </div>
          <div class="down">
            <textarea
              name="message"
              id="monami-input"
              maxlength="500"
              placeholder="Write your post here."
            ></textarea>
            <span>  <p id="char-count">0 / 500</p></span>
          
            <!-- Character counter display -->
          <input list="post-types" name="type" placeholder="Choose the post type" />
<datalist id="post-types">
  <option value="Articles">
  <option value="Posts">
</datalist>
<div class="btns">
     <button>Post</button>
    <a href="#"><button class="cancel" type="button">Cancel</button></a>
</div>

        </form>
      </section>
    <script>
  const textarea = document.getElementById("monami-input");
  const charCount = document.getElementById("char-count");
  const typeInput = document.querySelector('input[name="type"]');

  // Initial character counter
  textarea.addEventListener("input", () => {
    charCount.textContent = textarea.maxLength
      ? `${textarea.value.length} / ${textarea.maxLength}`
      : `${textarea.value.length} characters`;
  });

  // Change maxlength based on post type
  typeInput.addEventListener("input", () => {
    if (typeInput.value === "Articles") {
      textarea.removeAttribute("maxlength");
    } else {
      textarea.setAttribute("maxlength", "500");
      if (textarea.value.length > 500) {
        textarea.value = textarea.value.slice(0, 500); // trim it instantly
      }
    }

    // Force update count when switching type
    charCount.textContent = textarea.maxLength
      ? `${textarea.value.length} / ${textarea.maxLength}`
      : `${textarea.value.length} characters`;
  });
</script>
<script>
  const allowed = ["Articles", "Posts"];
  typeInput.addEventListener("input", () => {
    if (!allowed.includes(typeInput.value)) {
      typeInput.setCustomValidity("Choose one of the allowed post types.");
    } else {
      typeInput.setCustomValidity("");
    }
  });
</script>
  <script>
  function toggleBodyScroll() {
  if (window.location.hash === '#formPost') {
    document.body.style.overflow = 'hidden';   // Disable scroll when popup opened via hash
  } else {
    document.body.style.overflow = '';          // Enable scroll when hash removed
  }
}

// Initial check when page loads
window.addEventListener('DOMContentLoaded', toggleBodyScroll);

// Listen for any hash changes (like closing popup removes hash)
window.addEventListener('hashchange', toggleBodyScroll);

</script>
</main>
</div>
<script>
  const themeToggle = document.getElementById("themeToggle");
 const themeIcon = themeToggle.querySelector("span");
 
 // Load saved theme on page load
 const savedTheme = localStorage.getItem("theme");
 if (savedTheme) {
     document.documentElement.setAttribute("data-theme", savedTheme);
     themeIcon.textContent = savedTheme === "dark" ? "‚òÄÔ∏è" : "üåô";
 }
 
 // Toggle function
 themeToggle.addEventListener("click", () => {
     const currentTheme = document.documentElement.getAttribute("data-theme");
     const newTheme = currentTheme === "dark" ? "light" : "dark";
     document.documentElement.setAttribute("data-theme", newTheme);
     localStorage.setItem("theme", newTheme); // Save theme for all pages
     themeIcon.textContent = newTheme === "dark" ? "‚òÄÔ∏è" : "üåô";
 });
 
   
   </script>
   <style>
     body{
       background-color: var(--White--);
     }
     .themeToggle {
   display: flex;
   align-items: center;
   justify-content: flex-end !important;
   padding: 10px;
 }
 
 #themeToggle {
   width: 60px;
   height: 30px;
   border-radius: 30px;
   border: 1px solid var(--Black--) !important;
   background-color: var(--White--);
   position: relative;
   cursor: pointer;
   transition: background-color 0.3s ease;
 }
 
 #themeToggle .switch {
   position: absolute;
   top: 3px;
   left: 3px;
   width: 24px;
   height: 24px;
   background-color: var(--White--);
   border-radius: 50%;
   transition: transform 0.3s ease;
 }
 
 [data-theme="dark"] #themeToggle {
   background-color: var(--Blue--);
 }
 
 [data-theme="dark"] #themeToggle .switch {
   transform: translateX(30px);
 }
 
 .container {
  display: flex;
  flex-direction: column;
  width: 100%;
  gap: 20px;
  padding-bottom: 26px;
}

.container #post {
  background: var(--White--) !important;
  padding: 20px !important;
  border-radius: 15px !important;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.container #post:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 15px 35px rgba(28, 116, 228, 0.25);
}
h1,p {
  font-size: clamp(13px, 16px, 16px);
}
   </style>
  <script src="/Js/post.js" defer></script>  
  </body>
</html>
